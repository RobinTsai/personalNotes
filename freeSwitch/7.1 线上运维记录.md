# 线上运维记录

## 日志文件丢失

前提知识：FS 的日志配置了保存个数，假如为 64，则 .64 后缀是时间最早的那个, .63 次之并一次类推。

Fs 在重启时在内存中记录了一个计数，初始化为 1。当日志 rotate 时，会先判断 1 为后缀的文件存在否，若存在则删除。将当前日志文件更新为后缀 .1，并将计数变为 2。

当计数为 2 再次 logrotate 时，会判断 .2 的日志存在否，若存在则删除，然后将 .1 变更为 .2，当前日志文件更新为 .1，计数变为 3。依次类推。

因此，重启后，FS 重新计数存在内存中，按如上方式，重启前的日志会按时间顺序倒序逐个被替换。
