# 算法设计-无限栈

题目：通过 **有限个数组** 设计一个结构，此结构能存无限个栈，每个栈能同样处理 压栈、弹出 等操作。

要求：内存使用高效、操作复杂度高效。

实际场景：此题相当于一个“有标号的栈池”，内存结构紧密。

> 这里的“无限”是指系统能允许的最多个。

题解：

用五个数组
1. 栈数组，下标表示 栈 ID 号，栈中存栈顶在值数组的位置
2. 值数组，存储数据
3. last 数组，和值数组对应，表示此值的前一个值在值数组中的什么位置
4. 脏数组，存储值数组中各栈弹出的元素的下标值，用于值空间的复用
5. 栈大小数组，和 1 对应，下标表示栈 ID 号，值表示此栈的空间大小

简易版逻辑：
1. 添加一个栈时，在 1 的栈数组中添加一个元素
2. 向某个栈 i 中添加一个元素：在值数组中追加此元素值，将此值的下标更新到栈数组对应 i （栈）位置，将就的栈数组中下标位置更新到 last 数组中与值数组对应的位置，更新栈大小数组 i 位置 + 1
3. 在某个栈 i 中删除一个元素：找到栈数组 i 对应的值，此值为 值数组 的下标，标记值在值数组的位置，将此位置追加到 脏数据 的末尾，并将 值数组 的下标对应的 last 数组对应的值放入栈数组中，最后更新栈大小数组 i 位置 - 1.

补充逻辑解释：
- 脏数组相当于对 值数组 中删除元素造成的碎片形成一个链表，当向栈中添加元素的时候，可以首先从 脏数组 末尾取一个值作为下标，找到碎片位置并插入值数据
- 某一个栈中的元素都是分布在 值数组 中的，栈顶值的位置存储在 栈数组 中，而某一个值对应的上一个位置是存储在 last 数组中的。因此构成了 栈 空间。

代码就略了，如果面试遇见此题，思路在这里，随命吧。