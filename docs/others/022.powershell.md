# powerShell 的使用

- 安装 git 将 git/usr/bin 下有许多 linux 的小工具，将其添加到 path 中
- 输入 `$profile` 查看自动载入脚本目录
- 推荐安装 [gvim](https://github.com/vim/vim-win32-installer/releases) 客户端在 ps 中用（注意设置环境变量）
- powershell 7 有了自动补全的功能，Win10 可以安装，用这个版本
- [oh-my-posh 的主题地址](https://ohmyposh.dev/docs/themes)

```powershell
$PSVersionTable.PSVersion # 查看版本

$env:path                               # 查看 path
(type env:path) -split ';'              # 分行
(type env:path) -split ';' | sls python # 分行+过滤

# 在 powershwell 中设置临时的环境变量
$env:INCLUDE+=";C:\Program Files (x86)\Windows Kits\10\Include\10.0.26100.0\ucrt"

# alias
Set-Alias -Name list -Value get-childitem
Set-Alias list get-childitem
function getlist {Get-ChildItem -Name}
Set-Alias ls getlist
Remove-Item alias:ls

# 查看 profile 位置
$profile  # 输出变量值
New-Item -Type file -Force $profile # 创建对应文件

# 定义 alias
function getFileName{
    Get-ChildItem -Name
}
Remove-Item alias:ls
Set-Alias ls getFileName

# 快捷键部分
## 查看未绑定的快捷键
Get-PSReadLineKeyHandler -Unbound

# 安装 git, posh-git
Install-Module posh-git -Scope CurrentUser -Force  # 安装
Import-Module posh-git                             # 导入
Add-PoshGitToProfile -AllHosts                     # add posh-git to profile

Install-Module oh-my-posh -Scope CurrentUser -Force # 类似于 oh my zsh 的插件
```

# profile 最佳配置

- PS 的命令预测是 IntelliSense 模块提供的，默认是 InlineView（按 `→` 键使用）；按 F2 可与 ListView 间互相切换（按上下键进行选择）
- 使用 `. $profile` 使其在当前 shell 中生效

```powershell
# $profile 文件内容
Set-Alias l Get-ChildItem
function cybertron {Set-Location D:\workspace\cybertron}
Set-Alias cyber cybertron

Set-PSReadLineKeyHandler -Chord Ctrl+u -Function DeleteLine
Set-PSReadLineKeyHandler -Chord Ctrl+l -Function ClearScreen
Set-PSReadLineKeyHandler -Chord Ctrl+k -Function DeleteToEnd
Set-PSReadlineKeyHandler -Chord Ctrl+d -Function DeleteCharOrExit
Set-PSReadLineKeyHandler -Chord Alt+Backspace -Function BackwardKillWord
Set-PSReadLineKeyHandler -Chord Tab -Function TabCompleteNext
Set-PSReadLineKeyHandler -Chord Ctrl+a -Function BeginningOfLine

Set-PSReadLineOption -PredictionSource History -PredictionViewStyle ListView # 命令预测 使用 History 源，展示方式使用 ListView
```
