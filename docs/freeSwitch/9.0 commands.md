# commands

```sh
help # 帮助
sofia help # 模块帮助
sofia status profile internal reg # 查看已注册（登陆）设备（号码）

show channels # 显示通话中的一些信息，包含 UUID

originate user/1000 &park # 通过 1000 拨打电话到 park / hold / playback(/path/to.wav) / record(/path/to.wav) / bridge(user/1001)
bgapi originate user/91630476951603@preview.ccps.tryudesk.com &echo # 后台执行
bgapi originate sofia/gateway/gw1/Bob &echo # 测试网关是否通
uuid_bridge <uuid1> <uuid2> # 将两个 channel 桥接起来
originate {origination_caller_id_number=076933551276}user/97784649351005@preview.ccps.tryudesk.com &bridge({origination_caller_id_number=076933551276}sofia/gateway/vos3/18217562304)

sofia global siptrace on # 开启抓包输出
sofia profile external siptrace on # 单个 profile 的
sofia profile internal watchdog on # 监听 sofia sip 卡死的情况，30s 退出

# profile
sofia profile <profile> gwlist [up]|down
sofia profile <profile_name> killgw <gw_name>|_all_
sofia profile <profile_name> [<rescan>|<restart>] reloadxml
sofia profile <profile> flush_inbound_reg call_id|user@host # 清除某注册信息

console loglevel debug # 使用 fs_cli 可随时关闭配置，使日志驻留
sofia loglevel all 9 # 0 为关闭

load mod_xml_curl
reload mod_logfile  # 重启日志模块，重新滚动

uuid_kill <uuid> # 杀死某呼叫

bgapi originate user/97784649351005@preview.ccps.tryudesk.com &park # 94971dec-f789-4792-9085-59b6521baa3b

uuid_broadcast 94971dec-f789-4792-9085-59b6521baa3b playback::{var_play_uuid=89279646-01b1-491b-6495-c4f445cf9d19}udeskp://play_type=tts|app_id=6104fb0a-24cb-463d-717b-060384a6e7b6|tts_config=engine%3Dgoogle%2Cvoice_name%3Dcmn-CN-Standard-A%2Ctext_encoding%3Dutf8%2Csample_rate%3D8000%2Cspeed%3D50%2Cvolume%3D50%2Cpitch%3D50%2Crdn%3D2|tts_content=%E6%82%A8%E5%A5%BD%EF%BC%8C%E6%88%91%E6%98%AF%E7%BE%8E%E5%9B%A2%E5%AE%A2%E6%9C%8D%EF%BC%8C%E8%AF%B7%E9%97%AE%E6%9C%89%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E5%B8%AE%E6%82%A8%EF%BC%9F|offset=0

uuid_broadcast 94971dec-f789-4792-9085-59b6521baa3b playback::{var_play_uuid=89279646-01b1-491b-6495-c4f445cf9d19}udeskp://play_type=tts|app_id=6104fb0a-24cb-463d-717b-060384a6e7b6|tts_config=engine%3Dgoogle%2Cvoice_name%3Dcmn-CN-Standard-A%2Ctext_encoding%3Dutf8%2Csample_rate%3D8000%2Cspeed%3D50%2Cvolume%3D50%2Cpitch%3D50%2Crdn%3D2|tts_content=%E6%82%A8%E5%A5%BD%EF%BC%8C%E6%88%91%E6%98%AF%E7%BE%8E%E5%9B%A2%E5%AE%A2%E6%9C%8D%EF%BC%8C%E8%AF%B7%E9%97%AE%E6%9C%89%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E5%B8%AE%E6%82%A8%EF%BC%9F|offset=0

uuid_broadcast 94971dec-f789-4792-9085-59b6521baa3b playback::{var_play_uuid=5198945f-1fac-49e3-422c-79e59a7a0185}udeskp://play_type=tts|app_id=6104fb0a-24cb-463d-717b-060384a6e7b6|tts_config=engine%3Dgoogle%2Cvoice_name%3Dcmn-CN-Standard-A%2Ctext_encoding%3Dutf8%2Csample_rate%3D8000%2Cspeed%3D50%2Cvolume%3D50%2Cpitch%3D50%2Crdn%3D2|tts_content=...|offset=0

uuid_broadcast 94971dec-f789-4792-9085-59b6521baa3b playback::{var_play_uuid=32272c77-975f-4e3b-74ab-0cfc94b89706}udeskp://play_type=tts|app_id=6104fb0a-24cb-463d-717b-060384a6e7b6|tts_config=engine%3Dgoogle%2Cvoice_name%3Dcmn-CN-Standard-A%2Ctext_encoding%3Dutf8%2Csample_rate%3D8000%2Cspeed%3D50%2Cvolume%3D0%2Cpitch%3D50%2Crdn%3D2|tts_content=%E6%82%A8%E5%A5%BD%EF%BC%81|offset=0

uuid_broadcast 94971dec-f789-4792-9085-59b6521baa3b playback::{var_play_uuid=df0ddb76-6a8a-4eac-67a5-0100aec4372f}udeskp://play_type=tts|app_id=6104fb0a-24cb-463d-717b-060384a6e7b6|tts_config=engine%3Dgoogle%2Cvoice_name%3Dcmn-CN-Standard-A%2Ctext_encoding%3Dutf8%2Csample_rate%3D8000%2Cspeed%3D50%2Cvolume%3D0%2Cpitch%3D50%2Crdn%3D2|tts_content=%E8%AF%B7%E9%97%AE%E6%9C%89%E4%BB%80%E4%B9%88%E5%8F%AF%E4%BB%A5%E5%B8%AE%E5%8A%A9%E6%82%A8%E7%9A%84%E5%90%97%EF%BC%9F|offset=0
```

## 使用 Event Socket

```sh
# 这样用
sendmsg f023d674-f934-4fc8-b839-6ce6a1aea77d
call-command: execute
execute-app-name: playback
execute-app-arg: {var_play_uuid=df0ddb76-6a8a-4eac-67a5-0100aec4372f}udeskp://play_type=tts|app_id=6104fb0a-24cb-463d-717b-060384a6e7b6|tts_config=engine%3Dgoogle%2Cvoice_name%3Dcmn-CN-Standard-A%2Ctext_encoding%3Dutf8%2Csample_rate%3D8000%2Cspeed%3D50%2Cvolume%3D0%2Cpitch%3D50%2Crdn%3D2|tts_content=%E5%BB%BA%E8%AE%AE%E6%9B%B4%E6%8D%A2%E7%94%B5%E6%B1%A0%EF%BC%8CK70+Pro+Plus%E7%94%A8%E9%87%91%E9%9C%B8%E7%8E%8BUltra%E7%A2%B1%E6%80%A7%E7%94%B5%E6%B1%A0%EF%BC%8C%E5%85%B6%E4%BB%96%E5%9E%8B%E5%8F%B7%E8%AF%B7%E5%8F%82%E8%80%83%E6%89%8B%E5%86%8C%E3%80%82%E9%9C%80%E8%A6%81%E5%B8%AE%E5%8A%A9%E5%90%97%EF%BC%9F|offset=0
```
