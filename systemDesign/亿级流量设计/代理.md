# 代理

请求到确定的 IP 后，可以用代理再次将请求分发到服务。

代理：
- 反向代理：代理在服务端侧
- 正向代理：代理在客户端侧

四层反向代理：根据用户 IP 和端口进行转发
七层反向代理：根据用户协议、方法、请求头参数、正文参数进行转发

区别：
- 越接近于底层效率越高
- 越接近于高层功能越丰富、越智能

Nginx upstream：nginx 后方服务的节点
Nginx access_by_lua_file：根据 lua 脚本进行转发


## 负载均衡算法

- 轮询，RR，Round Robin，挨个轮询。代码实现：个数取模
- 权重：WRR，Weight Round Robin，按权重轮询。代码实现：前缀和+随机数计算
- 随机
- 哈希，按 IP 散列
- 最少连接，用 Redis 

（网上查远不止这几种算法）