# 运维技巧

- `redis-cli monitor | tee > /tmp/redis_monitor.log` 命令可以查看当前 redis 在执行什么命令。慎用，内存风暴风险。
- `redis-cli slowlog len` 查看 slowlog 条数
- `redis-cli slowlog get 129 > slow-129.log` 将 slowlog 导出最近的 129 条

## 问题记录

### scan 并发量大导致 CPU 占用 100%

命令：`scan INDEX match XXX:* count N`

关键现象：
- 流量偏移到 redis master 节点
- CPU 很高期间慢查询日志有 scan 操作，起止时间与 CPU 飙高时间差不多

[参考](https://zhuanlan.zhihu.com/p/381813397)
